{# Buttons macro #}
{% macro buttons(items, button1_style, button2_style) %}

  {% macro render_button(item) %}

    {% set href = item.button_link.url.href %}
    {% if item.button_link.url.type == "EXTERNAL" %}
      {% if href is not string_startingwith("tel:") %}
        {% set href = href|escape_url %}
      {% endif %}
    {% endif %}
    {% if item.button_link.url.type == "PHONE_NUMBER" %}
      {% set href = "tel:" + href %}
    {% endif %}
    {% if item.button_link.url.type == "EMAIL_ADDRESS" %}
      {% set href = "mailto:" + href %}
    {% endif %}    
    {% set rel = [] %}
    {% if item.button_link.no_follow %}
      {% do rel.append("nofollow") %}
    {% endif %}
    {% if item.button_link.open_in_new_tab %}
      {% do rel.append("noopener") %}
    {% endif %}    
      <a
        class="button
        {% if loop.index == 1 %}{{ button1_style }}{% endif %}
        {% if loop.index == 2 %}{{ button2_style }}{% endif %}"
        href="{{ href }}"
        {% if item.link.open_in_new_tab %}target="_blank"{% endif %}
        {% if rel %}rel="{{ rel|join(" ")|escape_attr }}"{% endif %}
      >
        <span>{{ item.button_text }}</span>
      </a>
  {% endmacro %}

  {% for item in items %}
    {{ render_button(item) }}
  {% endfor %}

{% endmacro %}